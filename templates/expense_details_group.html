<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel="stylesheet" href="/static/bootstrap-4.3.1-dist/css/bootstrap.min.css">
<link rel="stylesheet" href="/static/fontawesome-free-5.10.2-web/css/all.min.css">
<link rel="stylesheet" href="/static/style.css">
<script type="text/javascript">
    function LoadMain() {
        document.getElementsByName("form-navbar").action ="";
    }

    function Update_SubCategory() {
        document.getElementsByName("form-navbar").action ="group_expenses/";
    } 

    function add_payee(){
        var dropdown = document.getElementById("payee");
        var input = document.getElementById("payee-name").value
        var option = document.createElement("option");
        var ddlArray=new Array();
        var ddl= document.getElementById("payee");
        for (i=0;i<ddl.options.length; i++){
            ddlArray[i]=ddl.options[i].value;
        }
        if(input!="" && ddlArray.indexOf(input)==-1){
            option.text = option.value = document.getElementById("payee-name").value;
            dropdown.add(option);
            for (i=0;i<ddl.options.length; i++){
                ddlArray[i]=ddl.options[i].value;
            }
            document.getElementById("newpayee-list").value = ddlArray;
            document.getElementById("success").innerHTML="Payee inserted to the dropdown!!"
            document.getElementById("saveicon").className = "fas fa-check"
            document.getElementById("msg").className = "alert alert-success"
            document.getElementById("payee-name").value = ""
        }else if(ddlArray.indexOf(input)>-1){
            document.getElementById("success").innerHTML="Value Already Exists!!"
            document.getElementById("msg").className = "alert alert-danger"
        }else{
            document.getElementById("success").innerHTML="Input cannot be blank!!"
            document.getElementById("msg").className = "alert alert-danger"
        }
    }

    function clearMsg(){
        document.getElementById("msg").className = ""
        document.getElementById("success").innerHTML=""
    }
</script>
<title>Group Expenses Manager</title>
</head>
<body>
    <form id="form-navbar" method="POST">
        <nav class="navbar navbar-light bg-dark">
            <a class="navbar-brand text-white" href="#">
                <img src="/static/icon.jpg" width="50" height="50" class="d-inline-block align-center rounded-circle" alt="">
                    Group Expense Manager
            </a>
            <div class="align-right">
                <span class="text-white" id="userid"><i style="color: white; font-size: 15px" class="fas fa-user"></i> {{logintype}} : {{userid}}</span>
                <button type="submit" name='logout' value="Submit" class="btn btn-primary btn-sm" onclick="LoadMain()"><i class="fas fa-sign-in-alt"></i><font size="2">Logout</font></button><br>    
            </div>
        </nav>
        
        <div class="container expdetail-card card-body">
            <div class="card text-left mb-3">
                <h5 class="card-header">
                    <div class="row">
                        <div class="col-8">
                            <i class="fas fa-rupee-sign"></i>
                            <i style="color:red" class="fas fa-money-check-alt"></i>
                            <font size="4px">Add Expense</font>
                        </div>
                        <div class="col-4 text-right">
                            <h6><a href="{% url 'account' %}">Back to Account</a></h6>
                        </div>
                    </div>
                </h5>
                <div class="card-body">
                    <form id="expense-form" method="POST">
                        <ol class="breadcrumb">
                            <li class="breadcrumb-item"><a href="">{{cat_crumb}}</a></li>
                            <li class="breadcrumb-item active" aria-current="">{{subcat_crumb}}</li>
                        </ol>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <label class="input-group-text" for="group">Select Group</label>
                            </div>
                            <select class="custom-select" name="group" id="group">
                                {% for group in grouplist %}
                                    <option value="{{group}}">{{group}}</option>
                                {% endfor %}
                            </select>
                        </div>            
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="date">Date</span>
                            </div>
                            <input type="Date" name="date" value="{{date}}" class="form-control" aria-label="date" aria-describedby="date">
                        </div>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text">â‚¹</span>
                            </div>
                            <input type="number" name="amount" placeholder="0.00" class="form-control" aria-label="Amount">
                        </div>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <label class="input-group-text" for="payee">Payee</label>
                            </div>
                            <select class="custom-select" name="payee" id="payee">
                                {% for payee in payeelist %}
                                    <option value="{{payee}}">{{payee}}</option>
                                {% endfor %}
                            </select>
                            <div style="display: none;"> 
                                <input type="text" id="newpayee-list" name="newpayee-list">
                            </div>
                            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#add-payee">
                                <i class="fas fa-plus"></i> Add Payee
                            </button>
                        </div>    
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <label class="input-group-text" for="payment-method">Payment Method</label>
                            </div>
                            <select class="custom-select" name="payment-method" id="payment-method">
                                {% for pay_type in payment_meth %}
                                    <option value="{{pay_type}}">{{pay_type}}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="input-group mb-3">
                            <div class="input-group-prepend">
                                <span class="input-group-text" id="tag">#Tag</span>
                            </div>
                            <input type="text" class="form-control" name="tag" aria-label="tag" aria-describedby="tag expenses">
                        </div>    
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">Description</span>
                            </div>
                            <textarea class="form-control" name="description" aria-label="Enter Description of Expenses"></textarea>
                        </div>
                        <span id="errorvalue" style="color:red">{{errorvalue}}</span>
                        <span id="info" style="color:rgb(52, 185, 52)">{{info}}</span><br>
                        <div class="form-group text-center form-check">
                            <input type="checkbox" class="form-check-input" name="recurring" id="recurring" onclick="clearmsg()">
                            <label class="form-check-label" for="recurring">Save as Recurring</label><br><br>
                            <button type="submit" name='save' value="Submit" class="btn btn-primary" onclick="LoadMain()"><i class="fas fa-sign-in-alt"></i> Save</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <form id="form-navbar" method="POST">
            <div class="modal fade" id="add-payee" tabindex="1" role="dialog" aria-labelledby="add-payeelabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="add-payeelabel">Modal title</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                    <label class="input-group-text" for="payee">Payee Name</label>
                                </div> 
                                <input type="text" id="payee-name" name="payee-name" class="form-control" aria-label="Payee Name" onclick="clearMsg()" aria-describedby="inputGroup-sizing-default">   
                            </div>
                            <div id="msg" role="alert">
                                <span id="success"></span>  
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-secondary" onclick="add_payee()"><i id="saveicon" class="fas fa-sign-in-alt"></i> Save</button>                    
                        </div>
                    </div>
                </div>
            </div>            
        </form>
    </form>
<script type="text/javascript" src="/static/js/jquery.slim.min.js"></script>
<script type="text/javascript" src="/static/js/popper.min.js"></script>
<script type="text/javascript" src="/static/bootstrap-4.3.1-dist/js/bootstrap.min.js"></script>
</body>
</html>